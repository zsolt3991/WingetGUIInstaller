<Page x:Class="WingetGUIInstaller.Pages.MainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:controls="using:Microsoft.UI.Xaml.Controls"
      xmlns:converters="using:CommunityToolkit.WinUI.UI.Converters"
      xmlns:toolkit="using:CommunityToolkit.WinUI.UI.Controls"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <converters:BoolToVisibilityConverter x:Key="visibilityConverter" />
    </Page.Resources>

    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">

        <ContentDialog x:Name="UpdateDialog"
                       Title="Application Update Available" MinWidth="480" MinHeight="480" MaxWidth="480" MaxHeight="480"
                       HorizontalAlignment="Center" VerticalAlignment="Center"
                       PrimaryButtonCommand="{x:Bind ViewModel.InstallUpdateCommand}"
                       PrimaryButtonText="Update Now" SecondaryButtonText="Dismiss">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal">
                    <TextBlock Margin="5" FontSize="16" Text="New Version Available:" />
                    <TextBlock Margin="5" FontSize="16" Text="{x:Bind ViewModel.UpdateVersion, Mode=OneWay}" />
                </StackPanel>
                <toolkit:MarkdownTextBlock Grid.Row="1" Margin="5" Padding="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                           FontFamily="Consolas" LinkClicked="MarkdownTextBlock_LinkClicked"
                                           ScrollViewer.VerticalScrollBarVisibility="Auto"
                                           Text="{x:Bind ViewModel.UpdateChangeLog, Mode=OneWay}"
                                           TextWrapping="Wrap" />
            </Grid>
        </ContentDialog>

        <controls:NavigationView x:Name="NavView"
                                 Background="#FF1d1d1d" IsBackButtonVisible="Collapsed" IsBackEnabled="False"
                                 IsSettingsVisible="False" OpenPaneLength="280" SelectionChanged="NavView_SelectionChnage">
            <controls:NavigationView.MenuItems>
                <controls:NavigationViewItemHeader x:Name="MainPagesHeader" Content="Installation Options" />
                <controls:NavigationViewItem Content="Recommendations" Icon="SolidStar" Tag="recommend" />
                <controls:NavigationViewItem Content="Search Packages" Icon="Find" Tag="search" />
                <controls:NavigationViewItem Content="Update Packages" Icon="Refresh" Tag="update" />
                <controls:NavigationViewItem Content="Installed Packages" Icon="AllApps" Tag="list" />
                <controls:NavigationViewItem Content="Console" Tag="console" Visibility="{x:Bind ViewModel.IsConsoleEnabled, Mode=OneWay, Converter={StaticResource visibilityConverter}}">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE756;" />
                    </NavigationViewItem.Icon>
                </controls:NavigationViewItem>
            </controls:NavigationView.MenuItems>
            <controls:NavigationView.FooterMenuItems>
                <controls:NavigationViewItem Content="Settings" Icon="Setting" Tag="settings" />
                <controls:NavigationViewItem Content="About" Tag="about">
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE946;" />
                    </NavigationViewItem.Icon>
                </controls:NavigationViewItem>
            </controls:NavigationView.FooterMenuItems>
            <Grid>
                <Frame x:Name="ContentFrame" IsTabStop="True" />
            </Grid>
        </controls:NavigationView>
    </Grid>
</Page>
